<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Chapter 07 - Simulationstechniken</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Chapter 07 | Simulationstechniken</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Chapter 07" /> <meta name="author" content="Lars Pastewka" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Simulationstechniken" /> <meta property="og:description" content="Simulationstechniken" /> <link rel="canonical" href="http://localhost:4000/_lecture/chapter07.html" /> <meta property="og:url" content="http://localhost:4000/_lecture/chapter07.html" /> <meta property="og:site_name" content="Simulationstechniken" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-08-18T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Chapter 07" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Lars Pastewka"},"@type":"BlogPosting","description":"Simulationstechniken","url":"http://localhost:4000/_lecture/chapter07.html","headline":"Chapter 07","dateModified":"2021-08-18T00:00:00-05:00","datePublished":"2021-08-18T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/_lecture/chapter07.html"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Simulationstechniken </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_lecture/" class="nav-list-link">Vorlesung</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_homework/" class="nav-list-link">Übungsaufgaben</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_notes/" class="nav-list-link">Notizen</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="http://localhost:4000/impressum.html" class="nav-list-link">Impressum</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Simulationstechniken" aria-label="Search Simulationstechniken" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <!-- Add a favicon --> <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"> <link rel="stylesheet" href="/_includes/md.css"> <!-- Enable Katex for math rendering https://stackoverflow.com/a/57370526 --> <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"> <link rel="stylesheet" href="/_includes/md.css"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script> --> <script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <script> MathJax = { tex: { tags: 'ams' } }; $(document).ready(function(){ key = 'href'; $('[href^="https://uni-freiburg.cloud.panopto.eu"]').replaceWith(function() { return '<div class="video-container43"><iframe src='+$(this).attr(key)+' frameborder="0" allowfullscreen></iframe></div>'; }); $('[href^="https://www.youtube.com"]').replaceWith(function() { return '<div class="video-container169"><iframe src='+$(this).attr(key)+' frameborder="0" allowfullscreen></iframe></div>'; }); }); </script> <style type="text/css"> .video-container169 { position: relative; padding-bottom: 56.25%; /* 16:9 */ height: 0; } .video-container169 iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; } .video-container43 { position: relative; padding-bottom: 75%; /* 4:3; */ height: 0; } .video-container43 iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; } </style> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Lecture</a></li> <li class="breadcrumb-nav-list-item"><span>Chapter 07</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <hr /> <h2 class="chapterHead"> <a href="#x1-10007" class="anchor-heading" aria-labelledby="x1-10007"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span class="titlemark">Chapter 7</span><br /> <a id="x1-10007"></a>Domain decomposition </h2> <div id="shaded*-1" class="framedenv"><!-- l. 3 --> <p class="noindent"><span class="underline"><span class="cmbx-12">Context:</span></span> Parallelization in molecular dynamics typically occurs through <span class="cmti-12">domain</span> <span class="cmti-12">decomposition</span>. The simulation domain is divided into subdomains, each of which runs within an MPI process. This distributes the workload among different compute units. Communications occurs only at the interface of the subdomain, either to exchange atoms between subdomains or to communicate <span class="cmti-12">ghost atoms</span> that are required for the computation of correct forces in short-range interatomic potentials.</p> </div> <h3 class="sectionHead"> <a href="#x1-20007.1" class="anchor-heading" aria-labelledby="x1-20007.1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span class="titlemark">7.1</span> <a id="x1-20007.1"></a>Simulation domain </h3> <!-- l. 9 --> <p class="noindent">Our atomic system has so far lived in an infinite space consisting of vaccum. We have made no reference to a simulation domain and the code developed up to Milestone 07 makes not reference to such a domain. We now introduce domain decomposition and for this need a simulation domain, i.e. a region of space \(\Omega \) in which our atoms can reside. This domain can be periodic, which we will discuss in more detail in the next chapter.</p> <!-- l. 11 --> <p class="indent">We will assume that the simulation has its origin at \((0,0,0)\) and is spanned by three linearly independent vectors \(\vec{a}_1\), \(\vec{a}_2\) and \(\vec{a}_3\). Any atomic position can then be expressed as \begin{equation} \vec{r}_i = s_{i,1} \vec{a}_1 + s_{i,2}\vec{a}_2 + s_3 \vec{a}_{i,3} \end{equation} with \(s_\alpha \in [0,1)\). \(s_\alpha \) must remain in this interval since we do not allow atoms outside of the simulation domain. The vector \(\vec{s}_i\) is the scaled position of the atom \(i\). Using the <span class="cmti-12">domain matrix</span> \(\underline{A}=(\vec{a}_1, \vec{a}_2, \vec{a}_3)\), we can express this more compactly as \(\vec{r}_i=\underline{A}\cdot \vec{s}_i\). Conversely, we obtain the scaled positions from \(\vec{s}_i=\underline{A}^{-1}\cdot \vec{r}_i\).</p> <!-- l. 17 --> <p class="indent">In what follows, we assume rectilinear domains, i.e. \(\vec{a}_1=(L_x, 0, 0)\), \(\vec{a}_2=(0, L_y, 0)\) and \(\vec{a}_3=(0, 0, L_z)\) where \(L_x\), \(L_y\) and \(L_z\) are the linear dimensions of the domain. The methods that are described in the following are straightforwardly extended to arbitrary (tilted) domains.</p> <!-- l. 19 --> <p class="noindent"></p> <h3 class="sectionHead"> <a href="#x1-30007.2" class="anchor-heading" aria-labelledby="x1-30007.2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span class="titlemark">7.2</span> <a id="x1-30007.2"></a>Decomposition into Cartesian domains </h3> <!-- l. 21 --> <p class="noindent"><a href="https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=cee045e7-7cdb-4cda-ad4a-ad6b007de343" class="url"><span class="cmtt-12">https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=cee045e7-7cdb-4cda-ad4a-ad6b007de343</span></a></p> <!-- l. 23 --> <p class="indent">We decompose the full system into \(N_x\times N_y\times N_z\) subdomains. For a rectilinear domain, this means teach subdomain has linear dimensions of \(L_x/N_x\), \(L_y/N_y\) and \(L_z/N_z\). Each subdomain propagates its own atoms. When atoms leave the subdomain, they are transferred to the respective neighboring domain. We call this process <span class="cmti-12">atom</span> <span class="cmti-12">exchange</span>.</p> <!-- l. 25 --> <p class="indent">Domain decomposition algorithms for MD simulations have started to appear in the literature around 1990. Some of the earliest references to this type of algorithm are <a href="#Xbruge_concurrent_1990">Brugè and Fornili</a> (<a href="#Xbruge_concurrent_1990">1990</a>); <a href="#Xliem_molecular_1991">Liem et al.</a> (<a href="#Xliem_molecular_1991">1991</a>); <a href="#Xchynoweth_simulation_1991">Chynoweth et al.</a> (<a href="#Xchynoweth_simulation_1991">1991</a>); <a href="#Xpinches_large_1991">Pinches et al.</a> (<a href="#Xpinches_large_1991">1991</a>); <a href="#Xbrown_domain_1993">Brown et al.</a> (<a href="#Xbrown_domain_1993">1993</a>); <a href="#Xplimpton_fast_1995">Plimpton</a> (<a href="#Xplimpton_fast_1995">1995</a>).</p> <!-- l. 27 --> <p class="noindent"></p> <h3 class="sectionHead"> <a href="#x1-40007.3" class="anchor-heading" aria-labelledby="x1-40007.3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span class="titlemark">7.3</span> <a id="x1-40007.3"></a>Ghost atoms </h3> <!-- l. 29 --> <p class="noindent"><a href="https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=03a83e2f-54d9-4423-acb8-ad6b007de308" class="url"><span class="cmtt-12">https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=03a83e2f-54d9-4423-acb8-ad6b007de308</span></a></p> <!-- l. 31 --> <p class="indent">The atoms within each subdomain are not sufficient to compute the forces upon these atoms. In order to compute forces for atoms near the domain boundary, we need to transfer atoms that sit outside of the subdomain from the neighboring subdomains. These atoms are called ghost atoms. All atoms up to a distance \(r_\text{G}\) from the subdomain boundary are transferred. For a Lennard-Jones potential, \(r_\text{G}=r_c\) but for the EAM potential discussed here \(r_\text{G}=2 r_c\). This is because a force in the EAM potential is affected by an atom that sits twice the cutoff radius \(r_c\) away.</p> <!-- l. 33 --> <p class="noindent"></p> <h3 class="sectionHead"> <a href="#x1-50007.4" class="anchor-heading" aria-labelledby="x1-50007.4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span class="titlemark">7.4</span> <a id="x1-50007.4"></a>Communication pattern </h3> <!-- l. 35 --> <p class="noindent"><a href="https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=2ff96a92-b994-4cee-84b6-ad6b008fc0d3" class="url"><span class="cmtt-12">https://uni-freiburg.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=2ff96a92-b994-4cee-84b6-ad6b008fc0d3</span></a></p> <!-- l. 37 --> <p class="indent">The basic communication pattern involves two <span class="obeylines-h"><span class="verb"><span class="cmtt-12">MPI_Sendrecv</span></span></span> commands per Cartesian direction. The atoms that are send (either exchanged or as ghost atoms) must be serialized into a send buffer. Given that serialization has occured into the buffers <span class="obeylines-h"><span class="verb"><span class="cmtt-12">send_left</span></span></span> and <span class="obeylines-h"><span class="verb"><span class="cmtt-12">send_right</span></span></span>, the communication pattern looks as follows:</p> <!-- l. 38 --> <div id="listing-1" class="lstlisting"><span class="label"><a id="x1-5001r1"></a><span class="cmr-6">1</span></span><span class="cmtt-10">MPI_Sendrecv(&amp;send_left, left_, &amp;recv_right, right_, comm_)}; </span><br /> <span class="label"><a id="x1-5002r2"></a><span class="cmr-6">2</span></span><span class="cmtt-10">MPI_Sendrecv(&amp;send_right, right_, &amp;recv_left, left_, comm_)};</span></div> <!-- l. 42 --> <p class="indent">Here <span class="obeylines-h"><span class="verb"><span class="cmtt-12">comm_</span></span></span> contains the MPI communicator and <span class="obeylines-h"><span class="verb"><span class="cmtt-12">left_</span></span></span> and <span class="obeylines-h"><span class="verb"><span class="cmtt-12">right_</span></span></span> the MPI ranks of the processes that host the subdomain to the left and the right, respectively, of the current subdomain. The buffers <span class="obeylines-h"><span class="verb"><span class="cmtt-12">recv_left</span></span></span> and <span class="obeylines-h"><span class="verb"><span class="cmtt-12">recv_right</span></span></span> hold the serialized atomic information received from the left and right, respectively. This information needs to be deserialized into the respective atom data type.</p> <h2 class="likechapterHead"> <a href="#x1-60007.4" class="anchor-heading" aria-labelledby="x1-60007.4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="x1-60007.4"></a>Bibliography </h2> <div class="thebibliography"> <p class="bibitem"><span class="biblabel"><a id="Xbrown_domain_1993"></a><span class="bibsp">   </span></span>D. Brown, J. H. R. Clarke, M. Okuda, and T. Yamazaki. A domain decomposition parallelization strategy for molecular dynamics simulations on distributed memory machines. <span class="cmti-12">Comput. Phys. Comm.</span>, 74(1):67–80, 1993. URL <a href="https://doi.org/10.1016/0010-4655(93)90107-N" class="url"><span class="cmtt-12">https://doi.org/10.1016/0010-4655(93)90107-N</span></a>.</p> <p class="bibitem"><span class="biblabel"><a id="Xbruge_concurrent_1990"></a><span class="bibsp">   </span></span>F. Brugè and S. L. Fornili. Concurrent molecular dynamics simulation of spinodal phase transition on transputer arrays. <span class="cmti-12">Comput. Phys. Comm.</span>, 60(1):31–38, 1990. URL <a href="https://doi.org/10.1016/0010-4655(90)90076-D" class="url"><span class="cmtt-12">https://doi.org/10.1016/0010-4655(90)90076-D</span></a>.</p> <p class="bibitem"><span class="biblabel"><a id="Xchynoweth_simulation_1991"></a><span class="bibsp">   </span></span>S. Chynoweth, U. C. Klomp, and L. E. Scales. Simulation of organic liquids using pseudo-pairwise interatomic forces on a toroidal transputer array. <span class="cmti-12">Comput. Phys. Comm.</span>, 62(2):297–306, 1991. URL <a href="https://doi.org/10.1016/0010-4655(91)90102-Q" class="url"><span class="cmtt-12">https://doi.org/10.1016/0010-4655(91)90102-Q</span></a>.</p> <p class="bibitem"><span class="biblabel"><a id="Xliem_molecular_1991"></a><span class="bibsp">   </span></span>S. Y. Liem, D. Brown, and J. H. R. Clarke. Molecular dynamics simulations on distributed memory machines. <span class="cmti-12">Comput. Phys. Comm.</span>, 67(2):261–267, 1991. URL <a href="https://doi.org/10.1016/0010-4655(91)90021-C" class="url"><span class="cmtt-12">https://doi.org/10.1016/0010-4655(91)90021-C</span></a>.</p> <p class="bibitem"><span class="biblabel"><a id="Xpinches_large_1991"></a><span class="bibsp">   </span></span>M. R. S. Pinches, D. J. Tildesley, and W. Smith. Large scale molecular dynamics on parallel computers using the link-cell algorithm. <span class="cmti-12">Molecular</span> <span class="cmti-12">Simulation</span>, 6(1-3):51–87, 1991. URL <a href="https://doi.org/10.1080/08927029108022139" class="url"><span class="cmtt-12">https://doi.org/10.1080/08927029108022139</span></a>.</p> <p class="bibitem"><span class="biblabel"><a id="Xplimpton_fast_1995"></a><span class="bibsp">   </span></span>S. Plimpton. Fast parallel algorithms for short-range molecular dynamics. <span class="cmti-12">J. Comput. Phys.</span>, 117(1):1–19, 1995. URL <a href="https://doi.org/10.1006/jcph.1995.1039" class="url"><span class="cmtt-12">https://doi.org/10.1006/jcph.1995.1039</span></a>.</p> </div> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Andreas Greiner, 2020-2021 Lars Pastewka.</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
