<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Milestone 04 - Simulationstechniken</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Milestone 04 | Simulationstechniken</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Milestone 04" /> <meta name="author" content="Lars Pastewka" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Simulationstechniken" /> <meta property="og:description" content="Simulationstechniken" /> <link rel="canonical" href="http://localhost:4000/_homework/uebungsblatt04.html" /> <meta property="og:url" content="http://localhost:4000/_homework/uebungsblatt04.html" /> <meta property="og:site_name" content="Simulationstechniken" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Milestone 04" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Lars Pastewka"},"@type":"WebPage","description":"Simulationstechniken","url":"http://localhost:4000/_homework/uebungsblatt04.html","headline":"Milestone 04","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Simulationstechniken </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_lecture/" class="nav-list-link">Vorlesung</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_homework/" class="nav-list-link">Übungsaufgaben</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/_notes/" class="nav-list-link">Notizen</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="http://localhost:4000/impressum.html" class="nav-list-link">Impressum</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Simulationstechniken" aria-label="Search Simulationstechniken" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <!-- Add a favicon --> <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"> <link rel="stylesheet" href="/_includes/md.css"> <!-- Enable Katex for math rendering https://stackoverflow.com/a/57370526 --> <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"> <link rel="stylesheet" href="/_includes/md.css"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script> --> <script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <script> MathJax = { tex: { tags: 'ams' } }; $(document).ready(function(){ key = 'href'; $('[href^="https://uni-freiburg.cloud.panopto.eu"]').replaceWith(function() { return '<div class="video-container43"><iframe src='+$(this).attr(key)+' frameborder="0" allowfullscreen></iframe></div>'; }); $('[href^="https://www.youtube.com"]').replaceWith(function() { return '<div class="video-container169"><iframe src='+$(this).attr(key)+' frameborder="0" allowfullscreen></iframe></div>'; }); }); </script> <style type="text/css"> .video-container169 { position: relative; padding-bottom: 56.25%; /* 16:9 */ height: 0; } .video-container169 iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; } .video-container43 { position: relative; padding-bottom: 75%; /* 4:3; */ height: 0; } .video-container43 iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; } </style> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Project</a></li> <li class="breadcrumb-nav-list-item"><span>Milestone 04</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="milestone-4--lennard-jones-potential-with-direct-summation"> <a href="#milestone-4--lennard-jones-potential-with-direct-summation" class="anchor-heading" aria-labelledby="milestone-4--lennard-jones-potential-with-direct-summation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Milestone 4 <br /> Lennard-Jones potential with direct summation </h1> <h2 id="learning-goals"> <a href="#learning-goals" class="anchor-heading" aria-labelledby="learning-goals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Learning goals </h2> <p>The student will…</p> <ul> <li>…learn how to implement a simple interatomic potential.</li> <li>…learn how to systematically test the implementation of this interatomic potential.</li> </ul> <h2 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h2> <p>We will now implement our first interatomic potential: A Lennard-Jones interaction. The energy of a system interacting via Lennard-Jones forces is given by</p> \[E_\text{pot} = \frac{1}{2} \sum_{ij} 4 \varepsilon \left[ \left(\frac{\sigma}{r_{ij}}\right)^{12} - \left(\frac{\sigma}{r_{ij}}\right)^6\right]\] <p>The term \(\propto r^{-12}\) is a simple model for Pauli repulsion and the term \(\propto r^{-6}\) is a model for London dispersion forces. Within this milestone, you will implement this potential via direct summation, i.e. directly using the equation given above without cutting it off at a certain distance.</p> <p>Note that it can be useful to create a separate build target with a separate <code class="language-plaintext highlighter-rouge">main.cpp</code> for this milestone. Our notes on <a href="../_notes/CMake"><code class="language-plaintext highlighter-rouge">CMake</code></a> describe how to do that.</p> <h2 id="a-data-structure-for-the-atomic-system"> <a href="#a-data-structure-for-the-atomic-system" class="anchor-heading" aria-labelledby="a-data-structure-for-the-atomic-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A data structure for the atomic system </h2> <p>Before starting, we introduce a data structure that holds the information on the atomic system, i.e. the positions, velocities, forces etc. This makes it easier to pass the atomic system around. We suggest a data structure of the form:</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Positions_t</span> <span class="o">=</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Array3Xd</span><span class="p">;</span> 
<span class="k">using</span> <span class="n">Velocities_t</span> <span class="o">=</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Array3Xd</span><span class="p">;</span> 
<span class="k">using</span> <span class="n">Forces_t</span> <span class="o">=</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Array3Xd</span><span class="p">;</span> 
 
<span class="k">class</span> <span class="nc">Atoms</span> <span class="p">{</span> 
<span class="nl">public:</span> 
    <span class="n">Positions_t</span> <span class="n">positions</span><span class="p">;</span> 
    <span class="n">Velocities_t</span> <span class="n">velocities</span><span class="p">;</span> 
    <span class="n">Forces_t</span> <span class="n">forces</span><span class="p">;</span> 
 
    <span class="n">Atoms</span><span class="p">(</span><span class="k">const</span> <span class="n">Positions_t</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span> <span class="o">:</span> 
            <span class="n">positions</span><span class="p">{</span><span class="n">p</span><span class="p">},</span> <span class="n">velocities</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">cols</span><span class="p">()},</span> <span class="n">forces</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">cols</span><span class="p">()}</span> <span class="p">{</span> 
        <span class="n">velocities</span><span class="p">.</span><span class="n">setZero</span><span class="p">();</span> 
        <span class="n">forces</span><span class="p">.</span><span class="n">setZero</span><span class="p">();</span> 
    <span class="p">}</span> 
 
    <span class="n">Atoms</span><span class="p">(</span><span class="k">const</span> <span class="n">Positions_t</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="n">Velocities_t</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="o">:</span> 
            <span class="n">positions</span><span class="p">{</span><span class="n">p</span><span class="p">},</span> <span class="n">velocities</span><span class="p">{</span><span class="n">v</span><span class="p">},</span> <span class="n">forces</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">cols</span><span class="p">()}</span> <span class="p">{</span> 
        <span class="n">assert</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span><span class="p">.</span><span class="n">cols</span><span class="p">());</span>
        <span class="n">forces</span><span class="p">.</span><span class="n">setZero</span><span class="p">();</span> 
    <span class="p">}</span> 

    <span class="kt">size_t</span> <span class="n">nb_atoms</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> 
        <span class="k">return</span> <span class="n">positions</span><span class="p">.</span><span class="n">cols</span><span class="p">();</span> 
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <p>The <a href="https://en.cppreference.com/w/c/language/const"><code class="language-plaintext highlighter-rouge">const</code> qualifier</a> behind <code class="language-plaintext highlighter-rouge">nb_atoms</code> tells the compiler that this method does not change the state of the <code class="language-plaintext highlighter-rouge">Atoms</code> object, i.e. the value of <code class="language-plaintext highlighter-rouge">positions</code>, <code class="language-plaintext highlighter-rouge">velocities</code> and <code class="language-plaintext highlighter-rouge">forces</code> are not affected by a call to <code class="language-plaintext highlighter-rouge">nb_atoms</code>. Place this data structure in a separate header file, e.g. <code class="language-plaintext highlighter-rouge">atoms.h</code>. We had already discussed in [Milestone 3] that the types should reside in their own header, e.g. <code class="language-plaintext highlighter-rouge">types.h</code>. You can then simply include them in <code class="language-plaintext highlighter-rouge">atoms.h</code> by placing <code class="language-plaintext highlighter-rouge">#include "types.h"</code> somewhere at the beginning of the file. Make sure all header files have <a href="https://en.wikipedia.org/wiki/Include_guard">header guards</a>.</p> <h2 id="signature-of-the-function-that-computes-the-interatomic-potential"> <a href="#signature-of-the-function-that-computes-the-interatomic-potential" class="anchor-heading" aria-labelledby="signature-of-the-function-that-computes-the-interatomic-potential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Signature of the function that computes the interatomic potential </h2> <p>Implement the Lennard-Jones potential. Note that you will need to derive the <em>analytical</em> gradient of the total energy</p> \[\vec{f}_k = \nabla_k E\] <p>before you can implement the analytical forces. The final expression should take the form</p> \[\vec{f}_k = \sum_i \vec{f}_{ik}\] <p>where \(\vec{f}_{ik}\) is a pair force. (You need to evaluate the specific expression for \(\vec{f}_{ik}\) yourself.) This type of expression is most efficiently computed by looping over unique pairs.</p> <p>We suggest a function with the following signature:</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="nf">lj_direct_summation</span><span class="p">(</span><span class="n">Atoms</span> <span class="o">&amp;</span><span class="n">atoms</span><span class="p">,</span> <span class="kt">double</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="kt">double</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span>
</code></pre></div></div> <p>This signature defines default parameters for <code class="language-plaintext highlighter-rouge">epsilon</code> and <code class="language-plaintext highlighter-rouge">sigma</code>, i.e. they need to be specified only if they differ from unity. The function directly modifies the forces in <code class="language-plaintext highlighter-rouge">atoms.forces</code>. The return value of this function is the potential energy. Place this function in its own source and header file, e.g. <code class="language-plaintext highlighter-rouge">lj_direction_summation.h</code> and <code class="language-plaintext highlighter-rouge">lj_direct_summation.cpp</code>.</p> <h2 id="testing-the-implementation"> <a href="#testing-the-implementation" class="anchor-heading" aria-labelledby="testing-the-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Testing the implementation </h2> <p>When implementing this function you will want to test that the forces that are computed are correct. In particular, the forces and energy need to be consistent in the sense that the forces are the negative derivative of the energy. The energy is typically easy to implement correctly, but forces can be fiddly. One sign of wrong forces is that energy in a molecular dynamics simulation is not conserved, but there are also other causes for this effect (e.g. a time step that is too large) which makes it difficult as a test for the implementation of forces.</p> <p>The common strategy is to compute the forces <em>numerically</em> from the energies. For this, we have to compute a numerical first derivative. This is straightforward to do from the difference quotient, e.g.</p> \[f'(x) \approx \frac{f(x+\Delta x) - f(x-\Delta x)}{2 \Delta x}\] <p>A formal derivation of this expression can be obtained from a Taylor expansion of \(f(x)\). We can use this expression to compute numerical estimates of the forces. A test that uses this to test the analytical forces of the potential can be found here: <a href="test_lj_direct_summation.cpp">test_lj_direct_summation.cpp</a>. Place this file in your <code class="language-plaintext highlighter-rouge">tests</code> subdirectory and add it to the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> to use it. Open it in an editor and try to understand how the test works. This type of test is often called a <em>gradient test</em>.</p> <h2 id="a-first-molecular-dynamics-calculation"> <a href="#a-first-molecular-dynamics-calculation" class="anchor-heading" aria-labelledby="a-first-molecular-dynamics-calculation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A first molecular dynamics calculation </h2> <p>You are now in a position to run a first molecular dynamics calculation. To do this, you need a reasonable initial state for your simulation. The initial state is the initial condition for the solution of Newton’s equation of motion and requires you to specify positions and momenta. You can find such an initial state in the following file: <a href="lj54.xyz">lj54.xyz</a>. The format of this file is called the <a href="https://en.wikipedia.org/wiki/XYZ_file_format"><code class="language-plaintext highlighter-rouge">XYZ</code> file format</a>. We provide a C++ module for reading and writing these files here: <a href="xyz.h">xyz.h</a>, <a href="xyz.cpp">xyz.cpp</a>. Include these files into your project. Also open them in an editor and try to understand what they do.</p> <p>You can then read an XYZ-file using the following code block:</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include "xyz.h"
</span><span class="k">auto</span> <span class="p">[</span><span class="n">names</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">velocities</span><span class="p">]{</span><span class="n">read_xyz_with_velocities</span><span class="p">(</span><span class="s">"lj54.xyz"</span><span class="p">)};</span>
</code></pre></div></div> <p>The variable <code class="language-plaintext highlighter-rouge">names</code> contains the element names that you can discard at this point. Important are the variables <code class="language-plaintext highlighter-rouge">positions</code> and <code class="language-plaintext highlighter-rouge">velocities</code> that you should use as the initial state of your simulation. Note that the velocities contained in <a href="lj54.xyz">lj54.xyz</a> are an extension to the typical <a href="https://en.wikipedia.org/wiki/XYZ_file_format"><code class="language-plaintext highlighter-rouge">XYZ</code> file format</a> that is, however, understood by common visualization tools.</p> <p>Update your code to read this file and then propagate the simulation for a total time of at least \(100 \sqrt{m\sigma^2/\varepsilon} \). Use a mass of unity (\(m=1)\) and \(\varepsilon=1\) and \(\sigma=1\) for the Lennard-Jones interaction. A reasonable initial time step is \( 0.001 \sqrt{m\sigma^2/\varepsilon} \). Monitor the total energy of your simulation. For this you need to implement the computation of the kinetic energy.</p> <p>At this point you can quantify the influence of the time step on your simulation. Change the time step and see how the total energy evolves. What is a good time step for your simulation?</p> <h2 id="visualization"> <a href="#visualization" class="anchor-heading" aria-labelledby="visualization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Visualization </h2> <p>Since you have now run the first molecular dynamics calculation, it is useful to visualize your simulation, i.e. look at how the individual atoms move over time. To achieve this, output the state of the simulation as an <code class="language-plaintext highlighter-rouge">XYZ</code> at time intervals of order \(1 \sqrt{m\sigma^2/\varepsilon} \).</p> <p><code class="language-plaintext highlighter-rouge">XYZ</code>-files can be visualized with the <a href="https://www.ovito.org/">Open Visualization Tool (OVITO)</a>. Download <em>OVITO Basic</em>, install it and look at one of your <code class="language-plaintext highlighter-rouge">XYZ</code> files. To output trajectories, you can do two things:</p> <ul> <li>Consecutively number your files, e.g. <code class="language-plaintext highlighter-rouge">traj0000.xyz</code>, <code class="language-plaintext highlighter-rouge">traj0001.xyz</code>, <code class="language-plaintext highlighter-rouge">traj0002.xyz</code>, etc., OVITO will automatically detect that this is a sequence of files (a <em>trajectory</em>) and allow you visualize the time evolution of your atomic configuration.</li> <li>Write multiple <code class="language-plaintext highlighter-rouge">XYZ</code>s into the same file. Also here OVITO will autodetect that this is a trajectory. The following code snippets where <code class="language-plaintext highlighter-rouge">write_xyz</code> can be repeated as often as necessary does this:</li> </ul> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="nf">traj</span><span class="p">(</span><span class="s">"traj.xyz"</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">write_xyz</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atoms</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">write_xyz</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atoms</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">traj</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</code></pre></div></div> <p>The second approach has the advantage that there is only a single file that you need to work with, but it can be difficult to extract individual frames from it (e.g. for restarts of your simulation).</p> <h2 id="task-summary"> <a href="#task-summary" class="anchor-heading" aria-labelledby="task-summary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Task summary </h2> <p>This milestone requires the following tasks:</p> <ul> <li>Derive the analytical expression for the forces of the Lennard-Jones potential</li> <li>Implement the Lennard-Jones potential and make sure the gradient test passes</li> <li>Implement computation of the kinetic energy</li> <li>Run a first molecular dynamics simulation</li> <li>Decide on a “good” time step</li> <li>Download and install OVITO</li> <li>Visualize your simulation</li> </ul> <p>We ask you to provide the following analytical results in your final report:</p> <ul> <li>Derivation of the analytical expression for the forces of the Lennard-Jones potential</li> </ul> <p>We ask you to provide and discuss the following figures in your final report:</p> <ul> <li>Plot of the total energy as a function of time for different time steps</li> <li>A sequence of snapshots (no more than 5) from your simulation run</li> </ul> <p>We provide the following files for you:</p> <ul> <li><a href="lj54.xyz">lj54.xyz</a></li> <li><a href="test_lj_direct_summation.cpp">test_lj_direct_summation.cpp</a></li> <li><a href="xyz.h">xyz.h</a></li> <li><a href="xyz.cpp">xyz.cpp</a></li> </ul> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Andreas Greiner, 2020-2021 Lars Pastewka.</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
